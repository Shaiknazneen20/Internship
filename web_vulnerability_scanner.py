# web_vulnerability_scanner.py
# Author: CODTECH Internship
# Description: Scan websites for common vulnerabilities like SQL Injection and XSS.

import requests
from bs4 import BeautifulSoup
from urllib.parse import urljoin

def scan_sql_injection(url):
    payload = "' OR '1'='1"
    response = requests.get(url + payload)
    if "error" in response.text.lower() or "sql" in response.text.lower():
        print("[⚠] Possible SQL Injection vulnerability found!")
    else:
        print("[✔] No SQL Injection vulnerability detected.")

def scan_xss(url):
    payload = "<script>alert('XSS')</script>"
    response = requests.get(url, params={"q": payload})
    if payload in response.text:
        print("[⚠] Possible XSS vulnerability found!")
    else:
        print("[✔] No XSS vulnerability detected.")

def scan_forms(url):
    soup = BeautifulSoup(requests.get(url).text, "html.parser")
    forms = soup.find_all("form")
    print(f"[*] Found {len(forms)} forms on {url}")
    for form in forms:
        action = form.get("action")
        form_url = urljoin(url, action)
        print("[*] Scanning form:", form_url)
        scan_xss(form_url)
        scan_sql_injection(form_url)

if __name__ == "__main__":
    target = input("Enter target URL (e.g., https://example.com/search?q=test): ")
    scan_forms(target)